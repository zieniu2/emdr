<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EMDR Self-Help - Redukuj NapiÄ™cie</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #121212;
            color: white;
            padding: 20px;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .container {
            max-width: 100%;
            width: 100%;
            padding: 0 20px;
        }
        
        button {
            background-color: #9c27b0;
            color: white;
            border: none;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        button:hover {
            background-color: #7b1fa2;
        }
        
        .screen {
            display: none;
        }
        
        .active {
            display: block;
        }
        
        .indicator {
            width: 50px;
            height: 50px;
            background-color: #ff5722;
            border-radius: 50%;
            position: absolute;
            left: 0;
        }
        
        .indicator-container {
            width: 100%;
            height: 60px;
            background-color: #1e1e1e;
            border-radius: 5px;
            margin: 30px 0;
            position: relative;
            overflow: hidden;
        }
        
        .timer {
            font-size: 24px;
            margin: 20px 0;
        }
        
        .rating-button {
            display: inline-block;
            width: 30px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            background-color: #333;
            color: white;
            border-radius: 50%;
            margin: 5px;
            cursor: pointer;
        }
        
        .rating-button.selected {
            background-color: #ff5722;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Start Screen -->
        <div id="startScreen" class="screen active">
            <h1>EMDR Self-Help</h1>
            <p style="margin-bottom: 20px;">NarzÄ™dzie do szybkiego rozÅ‚adowania napiÄ™cia</p>
            
            <div style="background-color: #1e1e1e; padding: 15px; border-radius: 10px; text-align: left; margin-bottom: 20px; line-height: 1.5;">
                <p><strong>NarzÄ™dzie to pomoÅ¼e Ci:</strong></p>
                <ul style="list-style-type: none; padding-left: 5px; margin-top: 10px;">
                    <li>â€¢ PrzeÅ‚amaÄ‡ blokady perfekcjonizmu</li>
                    <li>â€¢ RozÅ‚adowaÄ‡ napiÄ™cie przed wymagajÄ…cymi zadaniami</li>
                    <li>â€¢ ZmniejszyÄ‡ reaktywnoÅ›Ä‡ emocjonalnÄ…</li>
                    <li>â€¢ WrÃ³ciÄ‡ do stanu rÃ³wnowagi</li>
                </ul>
            </div>
            
            <p style="font-size: 14px; color: #aaa; margin-bottom: 20px;">Metoda EMDR (Eye Movement Desensitization and Reprocessing) pomaga w przepracowaniu trudnych emocji i odczuÄ‡ poprzez stymulacjÄ™ bilateralnÄ….</p>
            
            <div style="margin-bottom: 20px;">
                <label style="display: flex; align-items: center; justify-content: center; cursor: pointer;">
                    <input type="checkbox" id="soundToggle" checked style="margin-right: 10px; transform: scale(1.5);">
                    <span>WÅ‚Ä…cz stymulacjÄ™ dÅºwiÄ™kowÄ…</span>
                </label>
                <p style="font-size: 12px; color: #aaa; margin-top: 5px;">(dla lepszego efektu uÅ¼ywaj sÅ‚uchawek)</p>
            </div>
            
            <button id="startButton">Rozpocznij sesjÄ™</button>
        </div>
        
        <!-- Rating Screen -->
        <div id="ratingScreen" class="screen">
            <h1>Przygotowanie do sesji EMDR</h1>
            
            <div style="background-color: #1e1e1e; padding: 20px; border-radius: 10px; text-align: left; margin-bottom: 20px; line-height: 1.6;">
                <h2 style="margin-bottom: 10px;">Instrukcja przed sesjÄ…:</h2>
                
                <p>1. <strong>Zajmij wygodnÄ… pozycjÄ™</strong> - usiÄ…dÅº prosto, ale komfortowo.</p>
                
                <p>2. <strong>Skup siÄ™ na problemie</strong> - pomyÅ›l o konkretnej sytuacji, ktÃ³ra wywoÅ‚uje napiÄ™cie (np. moment gdy siadasz do retuszu i czujesz presjÄ™ perfekcjonizmu).</p>
                
                <p>3. <strong>ZwrÃ³Ä‡ uwagÄ™ na swoje ciaÅ‚o</strong> - gdzie dokÅ‚adnie czujesz napiÄ™cie? W klatce piersiowej? W brzuchu? W ramionach? Zaobserwuj to uczucie.</p>
                
                <p>4. <strong>WyobraÅº sobie scenÄ™</strong> - przypomnij sobie jak najdokÅ‚adniej sytuacjÄ™, ktÃ³ra wywoÅ‚uje niepokÃ³j. Jakie obrazy widzisz? Jakie sÅ‚yszysz gÅ‚osy? Jakie myÅ›li siÄ™ pojawiajÄ…?</p>
                
                <p>5. <strong>Przyjmij to uczucie</strong> - nie walcz z nim, po prostu zaakceptuj Å¼e jest obecne.</p>
            </div>
            
            <p>Na skali od 1 do 10, jak silne jest Twoje napiÄ™cie zwiÄ…zane z tÄ… sytuacjÄ…?</p>
            <div id="ratingButtons">
                <div class="rating-button" data-value="1">1</div>
                <div class="rating-button" data-value="2">2</div>
                <div class="rating-button" data-value="3">3</div>
                <div class="rating-button" data-value="4">4</div>
                <div class="rating-button" data-value="5">5</div>
                <div class="rating-button" data-value="6">6</div>
                <div class="rating-button" data-value="7">7</div>
                <div class="rating-button" data-value="8">8</div>
                <div class="rating-button" data-value="9">9</div>
                <div class="rating-button" data-value="10">10</div>
            </div>
            <button id="beginButton">Rozpocznij ruch wskaÅºnika</button>
        </div>
        
        <!-- Session Screen -->
        <div id="sessionScreen" class="screen">
            <h1>ÅšledÅº wzrokiem poruszajÄ…cy siÄ™ wskaÅºnik</h1>
            <div style="margin-bottom: 10px; font-size: 16px;">Utrzymuj gÅ‚owÄ™ nieruchomo. ÅšledÅº kulkÄ™ tylko oczami.</div>
            <div class="timer" id="timerDisplay">01:00</div>
            <div class="indicator-container">
                <div id="indicator" class="indicator"></div>
            </div>
            <p style="margin-top: 20px;">JednoczeÅ›nie skup siÄ™ na odczuciach w ciele i pozwÃ³l myÅ›lom swobodnie pÅ‚ynÄ…Ä‡.</p>
            <p style="margin-top: 5px; color: #aaa;">Dotknij ekranu aby zatrzymaÄ‡/wznowiÄ‡</p>
            <button id="stopButton">ZakoÅ„cz sesjÄ™</button>
        </div>
        
        <!-- End Screen -->
        <div id="endScreen" class="screen">
            <h1>Sesja zakoÅ„czona</h1>
            
            <div style="background-color: #1e1e1e; padding: 20px; border-radius: 10px; text-align: left; margin-bottom: 20px; line-height: 1.6;">
                <h2 style="margin-bottom: 10px;">Instrukcje po sesji:</h2>
                
                <p>1. <strong>WeÅº gÅ‚Ä™boki oddech</strong> - wykonaj 3 gÅ‚Ä™bokie wdechy i wydechy.</p>
                
                <p>2. <strong>SprawdÅº swoje ciaÅ‚o</strong> - zauwaÅ¼, jak teraz czuje siÄ™ twoje ciaÅ‚o. Czy napiÄ™cie zmieniÅ‚o miejsce? Czy zmniejszyÅ‚o siÄ™? A moÅ¼e zniknÄ™Å‚o?</p>
                
                <p>3. <strong>Przypomnij sobie problematycznÄ… sytuacjÄ™</strong> - sprÃ³buj przywoÅ‚aÄ‡ tÄ™ samÄ… scenÄ™, o ktÃ³rej myÅ›laÅ‚eÅ› na poczÄ…tku. Czy wywoÅ‚uje te same uczucia?</p>
                
                <p>4. <strong>ZauwaÅ¼ zmiany</strong> - czy teraz myÅ›lisz o tej sytuacji inaczej? Czy pojawiÅ‚y siÄ™ nowe myÅ›li? Jak zmieniÅ‚y siÄ™ emocje?</p>
                
                <p>5. <strong>Zakotwicz nowy stan</strong> - jeÅ›li czujesz siÄ™ lepiej, zwrÃ³Ä‡ uwagÄ™ na to uczucie. MoÅ¼esz dotknÄ…Ä‡ kciukiem i palcem wskazujÄ…cym, tworzÄ…c "kotwicÄ™" dla tego stanu.</p>
            </div>
            
            <p>Jak oceniasz swoje napiÄ™cie teraz?</p>
            <div id="endRatingButtons">
                <div class="rating-button" data-value="1">1</div>
                <div class="rating-button" data-value="2">2</div>
                <div class="rating-button" data-value="3">3</div>
                <div class="rating-button" data-value="4">4</div>
                <div class="rating-button" data-value="5">5</div>
                <div class="rating-button" data-value="6">6</div>
                <div class="rating-button" data-value="7">7</div>
                <div class="rating-button" data-value="8">8</div>
                <div class="rating-button" data-value="9">9</div>
                <div class="rating-button" data-value="10">10</div>
            </div>
            
            <div style="background-color: #1e1e1e; padding: 15px; border-radius: 10px; text-align: left; margin: 20px 0; line-height: 1.6;">
                <h3 style="margin-bottom: 10px;">Co zaobserwowaÅ‚eÅ› podczas sesji?</h3>
                <p style="font-size: 14px; margin-bottom: 10px; color: #aaa;">Zaznacz wszystkie odpowiedzi, ktÃ³re do Ciebie pasujÄ…:</p>
                
                <div id="observationsContainer" style="display: flex; flex-direction: column; align-items: flex-start;">
                    <div class="checkbox-item" style="margin: 5px 0; display: flex; align-items: center;">
                        <input type="checkbox" id="obs1" style="margin-right: 10px; transform: scale(1.3);">
                        <label for="obs1">CzuÅ‚em fizyczne rozluÅºnienie w ciele</label>
                    </div>
                    
                    <div class="checkbox-item" style="margin: 5px 0; display: flex; align-items: center;">
                        <input type="checkbox" id="obs2" style="margin-right: 10px; transform: scale(1.3);">
                        <label for="obs2">ZauwaÅ¼yÅ‚em zmianÄ™ miejsca napiÄ™cia w ciele</label>
                    </div>
                    
                    <div class="checkbox-item" style="margin: 5px 0; display: flex; align-items: center;">
                        <input type="checkbox" id="obs3" style="margin-right: 10px; transform: scale(1.3);">
                        <label for="obs3">Nie zauwaÅ¼yÅ‚em fizycznych zmian</label>
                    </div>
                    
                    <div class="checkbox-item" style="margin: 5px 0; display: flex; align-items: center;">
                        <input type="checkbox" id="obs4" style="margin-right: 10px; transform: scale(1.3);">
                        <label for="obs4">Moje myÅ›li staÅ‚y siÄ™ spokojniejsze</label>
                    </div>
                    
                    <div class="checkbox-item" style="margin: 5px 0; display: flex; align-items: center;">
                        <input type="checkbox" id="obs5" style="margin-right: 10px; transform: scale(1.3);">
                        <label for="obs5">MiaÅ‚em trudnoÅ›ci z utrzymaniem koncentracji</label>
                    </div>
                    
                    <div class="checkbox-item" style="margin: 5px 0; display: flex; align-items: center;">
                        <input type="checkbox" id="obs6" style="margin-right: 10px; transform: scale(1.3);">
                        <label for="obs6">PojawiÅ‚y siÄ™ nowe myÅ›li/perspektywy</label>
                    </div>
                    
                    <div class="checkbox-item" style="margin: 5px 0; display: flex; align-items: center;">
                        <input type="checkbox" id="obs7" style="margin-right: 10px; transform: scale(1.3);">
                        <label for="obs7">Problem wydaje siÄ™ teraz mniej waÅ¼ny</label>
                    </div>
                    
                    <div class="checkbox-item" style="margin: 5px 0; display: flex; align-items: center;">
                        <input type="checkbox" id="obs8" style="margin-right: 10px; transform: scale(1.3);">
                        <label for="obs8">Odczuwam wiÄ™kszÄ… pewnoÅ›Ä‡ siebie w kwestii problemu</label>
                    </div>
                    
                    <div class="checkbox-item" style="margin: 5px 0; display: flex; align-items: center;">
                        <input type="checkbox" id="obs9" style="margin-right: 10px; transform: scale(1.3);">
                        <label for="obs9">Åatwiej mi myÅ›leÄ‡ o rozwiÄ…zaniach</label>
                    </div>
                    
                    <div class="checkbox-item" style="margin: 5px 0; display: flex; align-items: center;">
                        <input type="checkbox" id="obs10" style="margin-right: 10px; transform: scale(1.3);">
                        <label for="obs10">Oddychanie staÅ‚o siÄ™ gÅ‚Ä™bsze/spokojniejsze</label>
                    </div>
                    
                    <div class="checkbox-item" style="margin: 5px 0; display: flex; align-items: center;">
                        <input type="checkbox" id="obs11" style="margin-right: 10px; transform: scale(1.3);">
                        <label for="obs11">CzujÄ™, Å¼e potrzebujÄ™ wiÄ™cej sesji</label>
                    </div>
                    
                    <div class="checkbox-item" style="margin: 5px 0; display: flex; align-items: center;">
                        <input type="checkbox" id="obs12" style="margin-right: 10px; transform: scale(1.3);">
                        <label for="obs12">Nie zauwaÅ¼yÅ‚em Å¼adnych zmian</label>
                    </div>
                </div>
            </div>
            
            <div id="results" style="margin-top: 20px;"></div>
            
            <div style="background-color: #1e1e1e; padding: 15px; border-radius: 10px; text-align: left; margin: 20px 0; line-height: 1.6;">
                <p><strong>Co teraz?</strong></p>
                <p>â€¢ JeÅ›li napiÄ™cie znacznie siÄ™ zmniejszyÅ‚o (3+ punktÃ³w), moÅ¼esz przejÅ›Ä‡ do zadania.</p>
                <p>â€¢ JeÅ›li napiÄ™cie zmniejszyÅ‚o siÄ™ nieznacznie (1-2 punkty), rozwaÅ¼ przeprowadzenie jeszcze jednej sesji.</p>
                <p>â€¢ JeÅ›li napiÄ™cie nie zmieniÅ‚o siÄ™ lub wzrosÅ‚o, sprÃ³buj zidentyfikowaÄ‡ inny aspekt problemu i przeprowadÅº nowÄ… sesjÄ™.</p>
            </div>
            
            <button id="newSessionButton">Nowa sesja</button>
        </div>
    </div>

    <script>
        // Czekamy na zaÅ‚adowanie dokumentu
        window.onload = function() {
            // Zmienne globalne aplikacji
            var app = {
                screens: {
                    start: document.getElementById('startScreen'),
                    rating: document.getElementById('ratingScreen'),
                    session: document.getElementById('sessionScreen'),
                    end: document.getElementById('endScreen')
                },
                buttons: {
                    start: document.getElementById('startButton'),
                    begin: document.getElementById('beginButton'),
                    stop: document.getElementById('stopButton'),
                    newSession: document.getElementById('newSessionButton')
                },
                elements: {
                    indicator: document.getElementById('indicator'),
                    timerDisplay: document.getElementById('timerDisplay'),
                    results: document.getElementById('results'),
                    soundToggle: document.getElementById('soundToggle')
                },
                ratings: {
                    preButtons: document.querySelectorAll('#ratingButtons .rating-button'),
                    postButtons: document.querySelectorAll('#endRatingButtons .rating-button')
                },
                state: {
                    timeRemaining: 60,
                    preRating: null,
                    postRating: null,
                    isPaused: false,
                    timerId: null,
                    animationId: null,
                    soundEnabled: true,
                    audioContext: null
                }
            };
            
            // Funkcja pokazujÄ…ca wybrany ekran
            function showScreen(screenId) {
                // Ukryj wszystkie ekrany
                for (var key in app.screens) {
                    if (app.screens.hasOwnProperty(key)) {
                        app.screens[key].classList.remove('active');
                    }
                }
                
                // PokaÅ¼ wybrany ekran
                app.screens[screenId].classList.add('active');
            }
            
            // Funkcja obsÅ‚ugujÄ…ca timer
            function startTimer() {
                app.state.timeRemaining = 60;
                updateTimerDisplay();
                
                app.state.timerId = setInterval(function() {
                    if (!app.state.isPaused) {
                        app.state.timeRemaining--;
                        updateTimerDisplay();
                        
                        if (app.state.timeRemaining <= 0) {
                            endSession();
                        }
                    }
                }, 1000);
            }
            
            // Aktualizacja wyÅ›wietlacza timera
            function updateTimerDisplay() {
                var minutes = Math.floor(app.state.timeRemaining / 60);
                var seconds = app.state.timeRemaining % 60;
                app.elements.timerDisplay.textContent = 
                    minutes.toString().padStart(2, '0') + ':' + 
                    seconds.toString().padStart(2, '0');
            }
            
            // Inicjalizacja audio
            function setupAudio() {
                // PrÃ³bujemy uÅ¼yÄ‡ Web Audio API
                try {
                    app.state.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch(e) {
                    console.log('Web Audio API nie jest wspierane, uÅ¼ywam alternatywnej metody');
                }
            }
            
            // Funkcja odtwarzajÄ…ca dÅºwiÄ™k
            function playSound(isLeft) {
                // JeÅ›li dÅºwiÄ™k wyÅ‚Ä…czony lub pauza - nie odtwarzaj
                if (!app.state.soundEnabled || app.state.isPaused) return;
                
                // Metoda 1: Web Audio API
                if (app.state.audioContext) {
                    try {
                        var oscillator = app.state.audioContext.createOscillator();
                        var gainNode = app.state.audioContext.createGain();
                        
                        // Ustawienia oscylatora
                        oscillator.type = 'sine';
                        oscillator.frequency.value = isLeft ? 400 : 500;
                        
                        // GÅ‚oÅ›noÅ›Ä‡
                        gainNode.gain.value = 0.1;
                        
                        // Stworzenie kontekstu stereo
                        var panNode;
                        if (app.state.audioContext.createStereoPanner) {
                            panNode = app.state.audioContext.createStereoPanner();
                            panNode.pan.value = isLeft ? -1.0 : 1.0; // -1 = lewy, 1 = prawy
                        } else if (app.state.audioContext.createPanner) {
                            // Alternatywna metoda dla starszych przeglÄ…darek
                            panNode = app.state.audioContext.createPanner();
                            panNode.panningModel = 'equalpower';
                            panNode.setPosition(isLeft ? -1 : 1, 0, 0);
                        } else {
                            // Fallback - bez stereo
                            panNode = app.state.audioContext.createGain();
                        }
                        
                        // PodÅ‚Ä…czenia
                        oscillator.connect(gainNode);
                        gainNode.connect(panNode);
                        panNode.connect(app.state.audioContext.destination);
                        
                        // Odtwarzanie
                        oscillator.start();
                        
                        // Zatrzymanie po krÃ³tkim czasie
                        setTimeout(function() {
                            oscillator.stop();
                            // OdÅ‚Ä…czenie
                            try {
                                oscillator.disconnect();
                                gainNode.disconnect();
                                panNode.disconnect();
                            } catch(e) {
                                // Ignorujemy ewentualne bÅ‚Ä™dy odÅ‚Ä…czania
                            }
                        }, 50);
                    } catch(e) {
                        console.log('BÅ‚Ä…d odtwarzania dÅºwiÄ™ku:', e);
                        fallbackSound(isLeft);
                    }
                } 
                // Metoda 2: Element Audio z mono do stereo
                else {
                    fallbackSound(isLeft);
                }
            }
            
            // Alternatywna metoda generowania dÅºwiÄ™ku stereo
            function fallbackSound(isLeft) {
                try {
                    // Tworzymy kontekst AudioContext na Å¼Ä…danie
                    var tempContext = new (window.AudioContext || window.webkitAudioContext)();
                    var oscillator = tempContext.createOscillator();
                    var gainNode = tempContext.createGain();
                    
                    // Tworzymy kanaÅ‚ stereo
                    var merger = tempContext.createChannelMerger(2);
                    
                    // GÅ‚oÅ›noÅ›Ä‡
                    gainNode.gain.value = 0.2;
                    
                    // PodÅ‚Ä…czenia - manipulujemy ktÃ³rym kanaÅ‚em wysyÅ‚amy dÅºwiÄ™k
                    oscillator.connect(gainNode);
                    
                    // Ustawienia czÄ™stotliwoÅ›ci
                    oscillator.frequency.value = isLeft ? 400 : 500;
                    
                    if (isLeft) {
                        // Lewy kanaÅ‚
                        gainNode.connect(merger, 0, 0);
                    } else {
                        // Prawy kanaÅ‚
                        gainNode.connect(merger, 0, 1);
                    }
                    
                    merger.connect(tempContext.destination);
                    
                    // Odtwarzamy
                    oscillator.start();
                    
                    // Zatrzymujemy po krÃ³tkim czasie
                    setTimeout(function() {
                        oscillator.stop();
                        // OdÅ‚Ä…czamy
                        try {
                            oscillator.disconnect();
                            gainNode.disconnect();
                            merger.disconnect();
                        } catch(e) {
                            // Ignorujemy ewentualne bÅ‚Ä™dy odÅ‚Ä…czania
                        }
                        
                        // Zamykamy kontekst
                        try {
                            if (tempContext.close) {
                                tempContext.close();
                            }
                        } catch(e) {
                            // Ignorujemy bÅ‚Ä™dy zamykania
                        }
                    }, 50);
                } catch(e) {
                    console.log('Fallback audio teÅ¼ nie dziaÅ‚a:', e);
                    // Ostateczny fallback - bez stereo
                    try {
                        var audio = new Audio();
                        audio.volume = 0.2;
                        audio.src = "data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA==";
                        audio.play().catch(function(e) {
                            console.log('BÅ‚Ä…d odtwarzania dÅºwiÄ™ku:', e);
                        });
                    } catch(e) {
                        console.log('Wszystkie metody audio zawiodÅ‚y:', e);
                    }
                }
            }
            
            // Funkcja animujÄ…ca kulkÄ™
            function startAnimation() {
                var container = document.querySelector('.indicator-container');
                var containerWidth = container.offsetWidth;
                var indicatorWidth = app.elements.indicator.offsetWidth;
                var position = 0;
                var direction = 1; // 1 = prawo, -1 = lewo
                var speed = 12; // pikseli na klatkÄ™
                var wasAtEdge = false;
                
                function animate() {
                    if (!app.state.isPaused) {
                        position += speed * direction;
                        
                        // Zmiana kierunku na krawÄ™dziach
                        if (position >= containerWidth - indicatorWidth) {
                            position = containerWidth - indicatorWidth;
                            direction = -1;
                            
                            // DÅºwiÄ™k przy prawej krawÄ™dzi
                            if (!wasAtEdge) {
                                playSound(false);
                                wasAtEdge = true;
                            }
                        } else if (position <= 0) {
                            position = 0;
                            direction = 1;
                            
                            // DÅºwiÄ™k przy lewej krawÄ™dzi
                            if (!wasAtEdge) {
                                playSound(true);
                                wasAtEdge = true;
                            }
                        } else {
                            wasAtEdge = false;
                        }
                        
                        app.elements.indicator.style.left = position + 'px';
                    }
                    
                    app.state.animationId = requestAnimationFrame(animate);
                }
                
                app.state.animationId = requestAnimationFrame(animate);
            }
            
            // ZakoÅ„czenie sesji
            function endSession() {
                // Czyszczenie timerÃ³w
                clearInterval(app.state.timerId);
                if (app.state.animationId) {
                    cancelAnimationFrame(app.state.animationId);
                }
                
                showScreen('end');
            }
            
            // Aktualizacja wynikÃ³w
            function updateResults() {
                if (app.state.preRating !== null && app.state.postRating !== null) {
                    var diff = app.state.preRating - app.state.postRating;
                    var diffText, emoji, color;
                    
                    if (diff > 3) {
                        diffText = "Znaczne zmniejszenie o " + diff + " punktÃ³w";
                        emoji = "ğŸŒŸ";
                        color = "#4caf50";
                    } else if (diff > 0) {
                        diffText = "Zmniejszenie o " + diff + " punktÃ³w";
                        emoji = "ğŸ‘";
                        color = "#8bc34a";
                    } else if (diff === 0) {
                        diffText = "Brak zmiany";
                        emoji = "ğŸ”„";
                        color = "#ffc107";
                    } else {
                        diffText = "ZwiÄ™kszenie o " + Math.abs(diff) + " punktÃ³w";
                        emoji = "ğŸ“";
                        color = "#f44336";
                    }
                    
                    app.elements.results.innerHTML = '<div style="background-color: #222; padding: 15px; border-radius: 10px;">' +
                        '<p>' + emoji + ' <strong>Wyniki sesji:</strong></p>' +
                        '<p>NapiÄ™cie przed: <strong>' + app.state.preRating + '/10</strong></p>' +
                        '<p>NapiÄ™cie po: <strong>' + app.state.postRating + '/10</strong></p>' +
                        '<p style="margin-top: 10px; color: ' + color + '"><strong>' + diffText + '</strong></p>' +
                        '</div>';
                }
            }
            
            // ---- INICJALIZACJA EVENTÃ“W ----
            
            // Przycisk Start
            app.buttons.start.addEventListener('click', function() {
                showScreen('rating');
            });
            
            // Przycisk Rozpocznij ruch wskaÅºnika
            app.buttons.begin.addEventListener('click', function() {
                if (app.state.preRating === null) {
                    alert('ProszÄ™ wybraÄ‡ poziom napiÄ™cia');
                    return;
                }
                
                showScreen('session');
                setupAudio();
                startTimer();
                startAnimation();
            });
            
            // Przycisk ZakoÅ„cz sesjÄ™
            app.buttons.stop.addEventListener('click', function() {
                endSession();
            });
            
            // Przycisk Nowa sesja
            app.buttons.newSession.addEventListener('click', function() {
                // Reset stanu
                app.state.preRating = null;
                app.state.postRating = null;
                
                // Reset UI
                app.ratings.preButtons.forEach(function(btn) {
                    btn.classList.remove('selected');
                });
                app.ratings.postButtons.forEach(function(btn) {
                    btn.classList.remove('selected');
                });
                app.elements.results.innerHTML = '';
                
                showScreen('start');
            });
            
            // Przyciski oceny poczÄ…tkowej
            app.ratings.preButtons.forEach(function(button) {
                button.addEventListener('click', function() {
                    app.ratings.preButtons.forEach(function(btn) {
                        btn.classList.remove('selected');
                    });
                    this.classList.add('selected');
                    app.state.preRating = parseInt(this.getAttribute('data-value'));
                });
            });
            
            // Przyciski oceny koÅ„cowej
            app.ratings.postButtons.forEach(function(button) {
                button.addEventListener('click', function() {
                    app.ratings.postButtons.forEach(function(btn) {
                        btn.classList.remove('selected');
                    });
                    this.classList.add('selected');
                    app.state.postRating = parseInt(this.getAttribute('data-value'));
                    updateResults();
                });
            });
            
            // PrzeÅ‚Ä…cznik dÅºwiÄ™ku
            app.elements.soundToggle.addEventListener('change', function() {
                app.state.soundEnabled = this.checked;
            });
            
            // Pauza/wznowienie na klikniÄ™cie ekranu sesji
            app.screens.session.addEventListener('click', function(e) {
                // Ignoruj klikniÄ™cie na przycisk stop
                if (e.target === app.buttons.stop) return;
                
                app.state.isPaused = !app.state.isPaused;
                app.screens.session.style.backgroundColor = 
                    app.state.isPaused ? '#2d1d30' : '#121212';
            });
        };
    </script>
</body>
</html>
